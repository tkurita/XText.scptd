<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">  <!-- InstanceBegin template="../../../../../_Templates/helpbook-page-with-applescript.dwt" -->    <head>      <meta name="keywords" content="XText, AppleScript, sample" />      <meta http-equiv="content-type" content="text/html;charset=utf-8" />      <title>Synopsis</title>            <meta name="description" content="XText extend AppleScript's text object and allow to various text manipulation with compact code." />      <!-- #BeginHeadLocked "" -->        <link href="assets/helpbook-default.css" type="text/css" rel="stylesheet" media="all" />        <link href="assets/helpbook-navibar.css" type="text/css" rel="stylesheet" media="all" />        <script type="text/javascript" src="assets/navibar-jump.js"></script>        <link id="helpviewer-handler-helper" href="assets/helpviewer-handler-helper.scpt" />        <script type="text/javascript" src="assets/helpviewer-handler-enable.js"></script>      <!-- #EndHeadLocked -->      <link id="HelpBookRoot" href="../" />      <csimport user="../../../_Components/sample-code.html" occur="43">        <link href="assets/AppleScript-2016.css" rel="stylesheet" type="text/css" media="all" />      </csimport>    </head>    <body>      <!-- InstanceBeginEditable name="navi-bar" --><div id="navi-bar"><span class="navibar-item"><a href="../index.html">XText Help</a></span><span class="navibar-item">Synopsis</span><select onchange="navibarJump(this)"><option value="">ยง</option>
    <option value="#what">What</option>
    <option value="#sample">Sample</option>
    <option value="#using_class_methods">- Using Class Methods</option>
    <option value="#using_instance_methods">- Using Instance Methods</option></select></div>
<div class="prev-next-item"><a href="../02_reference/index.html"><span class="navibar-next">XText Reference </span></a></div><!-- InstanceEndEditable -->      <div id="contents">        <!-- InstanceBeginEditable name="Body" -->          <h1>XText</h1>          <h2><a id="what" name="what"></a>What</h2>                    <p>XText is a wrapper object of AppleScript's text object to provide object oriented interface to manipulate text. You can describe complex text handlings with simple statements.</p>                    <p>The parent of instances of XText is AppleScript's text object. Therefore ...</p>          <ul>            <li>Properties of AppleScript's text can be obtained form a XText instance in same way to normal AppleScript's text object (string and Unicode text).              <ul>                <li>e.g., length of a_text, word 1 of a_text</li>              </ul>            </li>            <li>An instance of XText is immutable like string or Unicode class object.</li>          </ul>                    <p>There are same purpose methods in the both of class methods and instance methods (e.g., repace, split and so on). But there are folloing differeces.</p>          <ul>            <li>Class methods              <ul>                <li>Return Unicode text object.</li>                <li>AppleScript's text item delimiters must be managed by yourself using store_delimiters and restore_delimiters</li>              </ul>            </li>            <li>Instance methods              <ul>                <li>Return a new XText instance.</li>                <li>AppleScript's text item delimiters is not reverted to the value before calling instance methods automatically.</li>              </ul>            </li>          </ul>                    <h2><a id="sample" name="sample"></a>Sample</h2>          <csobj csref="../../../_Components/sample-code.html" occur="43" t="Component">            <h3><a id="using_class_methods" name="using_class_methods"></a>Using Class Methods</h3>            <div class="sourceCode" >              <div class="scriptButton" style="float:right;" >                <input type="button" value=" Open this script : Class Methods" onclick="document.location = this.src" src="applescript://com.apple.scripteditor?action=new&amp;script=use%20XText%20:%20script%20%22XText%22%0D%0Dtell%20XText%0D%09store_delimiters()%20--%20storing%20AppleScript%27s%20text%20item%20delimiters%0D%09%0D%09log%20(replace%20for%20%22this%20is%20a%20pen%22%20from%20%22pen%22%20by%20%22flower%22)%0D%09(*this%20is%20a%20flower*)%0D%09%0D%09set%20a_list%20to%20split(%22this%20is%20a%20pen%22,%20space)%0D%09log%20a_list%20--%20(*this,%20is,%20a,%20pen*)%0D%09log%20join_list(a_list,%20%22-%22)%20--%20(*this-is-a-pen*)%0D%09%0D%09log%20strip(%22%20%20this%20is%20a%20pen%20%20%20%22)%20--%20(*this%20is%20a%20pen*)%0D%09log%20strip_beginning(%22%20%20%20this%20is%20a%20pen%20%20%20%22)%0D%09--%20%7B%22%20%20%20%22,%20%22this%20is%20a%20pen%20%20%22%7D%0D%09log%20strip_endding(%22%20%20this%20is%20a%20pen%20%20%20%22)%0D%09--%20%7B%22%20%20%20%22,%22%20%20%20this%20is%20a%20pen%22%7D%0D%09%0D%09log%20formatted_text(%22$1%20is%20$2.%22,%20%7B%22XText%22,%20%22useful%22%7D)%0D%09(*XText%20is%20useful.*)%0D%09%0D%09restore_delimiters()%20--%20restoring%20AppleScript%27s%20text%20item%20delimiters%0Dend%20tell%0D" /></div>              <div>                <span class="langKeyword">use</span> <span class="userDefine">XText</span><span class="normal"> : </span><span class="className">script</span><span class="normal"> &quot;XText&quot;</span></div>              <br />              <div>                <span class="langKeyword">tell</span> <span class="userDefine">XText</span></div>              <div style="text-indent:4ex;">                <span class="userDefine">store_delimiters</span><span class="normal">() </span><span class="comment">-- storing AppleScript's text item delimiters</span></div>              <br />              <div style="text-indent:4ex;">                <span class="commandName">log</span><span class="normal"> (</span><span class="userDefine">replace</span> <span class="appKeyword">for</span><span class="normal"> &quot;this is a pen&quot; </span><span class="appKeyword">from</span><span class="normal"> &quot;pen&quot; </span><span class="appKeyword">by</span><span class="normal"> &quot;flower&quot;)</span></div>              <div style="text-indent:4ex;">                <span class="comment">(*this is a flower*)</span></div>              <br />              <div style="text-indent:4ex;">                <span class="langKeyword">set</span> <span class="userDefine">a_list</span> <span class="langKeyword">to</span> <span class="userDefine">split</span><span class="normal">(&quot;this is a pen&quot;, </span><span class="propertyName">space</span><span class="normal">)</span></div>              <div style="text-indent:4ex;">                <span class="commandName">log</span> <span class="userDefine">a_list</span> <span class="comment">-- (*this, is, a, pen*)</span></div>              <div style="text-indent:4ex;">                <span class="commandName">log</span> <span class="userDefine">join_list</span><span class="normal">(</span><span class="userDefine">a_list</span><span class="normal">, &quot;-&quot;) </span><span class="comment">-- (*this-is-a-pen*)</span></div>              <br />              <div style="text-indent:4ex;">                <span class="commandName">log</span> <span class="userDefine">strip</span><span class="normal">(&quot;  this is a pen   &quot;) </span><span class="comment">-- (*this is a pen*)</span></div>              <div style="text-indent:4ex;">                <span class="commandName">log</span> <span class="userDefine">strip_beginning</span><span class="normal">(&quot;   this is a pen   &quot;)</span></div>              <div style="text-indent:4ex;">                <span class="comment">-- {&quot;   &quot;, &quot;this is a pen  &quot;}</span></div>              <div style="text-indent:4ex;">                <span class="commandName">log</span> <span class="userDefine">strip_endding</span><span class="normal">(&quot;  this is a pen   &quot;)</span></div>              <div style="text-indent:4ex;">                <span class="comment">-- {&quot;   &quot;,&quot;   this is a pen&quot;}</span></div>              <br />              <div style="text-indent:4ex;">                <span class="commandName">log</span> <span class="userDefine">formatted_text</span><span class="normal">(&quot;$1 is $2.&quot;, {&quot;XText&quot;, &quot;useful&quot;})</span></div>              <div style="text-indent:4ex;">                <span class="comment">(*XText is useful.*)</span></div>              <br />              <div style="text-indent:4ex;">                <span class="userDefine">restore_delimiters</span><span class="normal">() </span><span class="comment">-- restoring AppleScript's text item delimiters</span></div>              <div>                <span class="langKeyword">end</span> <span class="langKeyword">tell</span></div>            </div>            <h3><a id="using_instance_methods" name="using_instance_methods"></a>Using Instance Methods</h3>            <div class="sourceCode" >              <div class="scriptButton" style="float:right;">                <input type="button" value=" Open this script : Instance Methods" onclick="document.location = this.src" src="applescript://com.apple.scripteditor?action=new&amp;script=use%20XText%20:%20script%20%22XText%22%0D%0D(*==%20Make%20a%20XText%20Instance%20*)%0Dset%20a_text%20to%20XText%27s%20make_with(%22this%20is%20a%20pen%22)%0D%0D(*==%20Replacing%20*)%0Dlog%20a_text%27s%20replace(%22pen%22,%20%22flower%22)%0D(*%5BXText%5D%20this%20is%20a%20flower*)%0D%0D(*==%20Appending%20and%20Prepennding%20*)%0Dset%20spaced_text%20to%20a_text%27s%20prepend(return%20%26%20tab)%0Dset%20spaced_text%20to%20spaced_text%27s%20push(space)%0D%0Dlog%20spaced_text%0D(*%5BXText%5D%20%0D%09this%20is%20a%20pen%20*)%0D%0D(*==%20Stripping%20*)%0Dlog%20spaced_text%27s%20strip()%20--%20(*%5BXText%5D%20this%20is%20a%20pen*)%0D%0Dset%20a_result%20to%20spaced_text%27s%20strip_beginning()%0Dlog%20item%201%20of%20a_result%0D(*%0D%09*)%0Dlog%20item%202%20of%20a_result%0D(*%5BXText%5D%20this%20is%20a%20pen%20*)%0D%0Dset%20a_result%20to%20spaced_text%27s%20strip_endding()%0Dlog%20item%201%20of%20a_result%0D(*%20*)%0Dlog%20item%202%20of%20a_result%0D(*%5BXText%5D%20%0D%09this%20is%20a%20pen*)%0D%0D(*==%20Check%20Contents%20*)%0Dlog%20a_text%27s%20starts_with(%22this%22)%20--%20(*true*)%0Dlog%20a_text%27s%20ends_with(%22this%22)%20--%20(*false*)%0Dlog%20a_text%27s%20include(%22is%22)%20--%20(*true*)%0Dlog%20a_text%27s%20offset_of(%22is%22)%20--%20(*3*)%0D%0D(*==%20Make%20a%20list%20with%20splitting%20*)%0Dlog%20a_text%27s%20as_xlist_with(space)%0D(*%5BXList%5D%0D1%09this%0D2%09is%0D3%09a%0D4%09pen*)%0D%0Dlog%20a_text%27s%20as_list_with(space)%20--%20(*this,%20is,%20a,%20pen*)%0D%0D(*==%20Obtain%20a%20part%20of%20text%20*)%0Dlog%20a_text%27s%20character_at(1)%20--%20(*%5BXText%5D%20t*)%0Dlog%20a_text%27s%20word_at(1)%20--%20(*%5BXText%5D%20this*)%0Dlog%20a_text%27s%20paragraph_at(1)%20--%20(*%5BXText%5D%20this%20is%20a%20pen*)%0D%0D(*==%20Obtain%20of%20AppleScript%27s%20text%20properties%20*)%0Dlog%20character%201%20of%20a_text%20--%20(*t*)%0Dlog%20word%201%20of%20a_text%20--%20(*this*)%0Dlog%20length%20of%20a_text%20--%20(*13*)%0D%0D(*==%20Obtain%20content%20as%20AppleScript%27s%20text%20*)%0Da_text%27s%20as_unicode()%0Da_text%27s%20as_string()" /></div>              <div>                <span class="langKeyword">use</span> <span class="userDefine">XText</span><span class="normal"> : </span><span class="className">script</span><span class="normal"> &quot;XText&quot;</span></div>              <br />              <div>                <span class="comment">(*== Make a XText Instance *)</span></div>              <div>                <span class="langKeyword">set</span> <span class="userDefine">a_text</span> <span class="langKeyword">to</span> <span class="userDefine">XText's</span> <span class="userDefine">make_with</span><span class="normal">(&quot;this is a pen&quot;)</span></div>              <br />              <div>                <span class="comment">(*== Replacing *)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">replace</span><span class="normal">(&quot;pen&quot;, &quot;flower&quot;)</span></div>              <div>                <span class="comment">(*[XText] this is a flower*)</span></div>              <br />              <div>                <span class="comment">(*== Appending and Prepennding *)</span></div>              <div>                <span class="langKeyword">set</span> <span class="userDefine">spaced_text</span> <span class="langKeyword">to</span> <span class="userDefine">a_text's</span> <span class="userDefine">prepend</span><span class="normal">(</span><span class="propertyName">return</span><span class="normal"> &amp; </span><span class="propertyName">tab</span><span class="normal">)</span></div>              <div>                <span class="langKeyword">set</span> <span class="userDefine">spaced_text</span> <span class="langKeyword">to</span> <span class="userDefine">spaced_text's</span> <span class="userDefine">push</span><span class="normal">(</span><span class="propertyName">space</span><span class="normal">)</span></div>              <br />              <div>                <span class="commandName">log</span> <span class="userDefine">spaced_text</span></div>              <div>                <span class="comment">(*[XText] </span></div>              <div style="text-indent:4ex;">                <span class="comment">this is a pen *)</span></div>              <br />              <div>                <span class="comment">(*== Stripping *)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">spaced_text's</span> <span class="userDefine">strip</span><span class="normal">() </span><span class="comment">-- (*[XText] this is a pen*)</span></div>              <br />              <div>                <span class="langKeyword">set</span> <span class="userDefine">a_result</span> <span class="langKeyword">to</span> <span class="userDefine">spaced_text's</span> <span class="userDefine">strip_beginning</span><span class="normal">()</span></div>              <div>                <span class="commandName">log</span> <span class="className">item</span><span class="normal"> 1 </span><span class="langKeyword">of</span> <span class="userDefine">a_result</span></div>              <div>                <span class="comment">(*</span></div>              <div style="text-indent:4ex;">                <span class="comment">*)</span></div>              <div>                <span class="commandName">log</span> <span class="className">item</span><span class="normal"> 2 </span><span class="langKeyword">of</span> <span class="userDefine">a_result</span></div>              <div>                <span class="comment">(*[XText] this is a pen *)</span></div>              <br />              <div>                <span class="langKeyword">set</span> <span class="userDefine">a_result</span> <span class="langKeyword">to</span> <span class="userDefine">spaced_text's</span> <span class="userDefine">strip_endding</span><span class="normal">()</span></div>              <div>                <span class="commandName">log</span> <span class="className">item</span><span class="normal"> 1 </span><span class="langKeyword">of</span> <span class="userDefine">a_result</span></div>              <div>                <span class="comment">(* *)</span></div>              <div>                <span class="commandName">log</span> <span class="className">item</span><span class="normal"> 2 </span><span class="langKeyword">of</span> <span class="userDefine">a_result</span></div>              <div>                <span class="comment">(*[XText] </span></div>              <div style="text-indent:4ex;">                <span class="comment">this is a pen*)</span></div>              <br />              <div>                <span class="comment">(*== Check Contents *)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">starts_with</span><span class="normal">(&quot;this&quot;) </span><span class="comment">-- (*true*)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">ends_with</span><span class="normal">(&quot;this&quot;) </span><span class="comment">-- (*false*)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">include</span><span class="normal">(&quot;is&quot;) </span><span class="comment">-- (*true*)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">offset_of</span><span class="normal">(&quot;is&quot;) </span><span class="comment">-- (*3*)</span></div>              <br />              <div>                <span class="comment">(*== Make a list with splitting *)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">as_xlist_with</span><span class="normal">(</span><span class="propertyName">space</span><span class="normal">)</span></div>              <div>                <span class="comment">(*[XList]</span></div>              <div>                <span class="comment">1	this</span></div>              <div>                <span class="comment">2	is</span></div>              <div>                <span class="comment">3	a</span></div>              <div>                <span class="comment">4	pen*)</span></div>              <br />              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">as_list_with</span><span class="normal">(</span><span class="propertyName">space</span><span class="normal">) </span><span class="comment">-- (*this, is, a, pen*)</span></div>              <br />              <div>                <span class="comment">(*== Obtain a part of text *)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">character_at</span><span class="normal">(1) </span><span class="comment">-- (*[XText] t*)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">word_at</span><span class="normal">(1) </span><span class="comment">-- (*[XText] this*)</span></div>              <div>                <span class="commandName">log</span> <span class="userDefine">a_text's</span> <span class="userDefine">paragraph_at</span><span class="normal">(1) </span><span class="comment">-- (*[XText] this is a pen*)</span></div>              <br />              <div>                <span class="comment">(*== Obtain of AppleScript's text properties *)</span></div>              <div>                <span class="commandName">log</span> <span class="className">character</span><span class="normal"> 1 </span><span class="langKeyword">of</span> <span class="userDefine">a_text</span> <span class="comment">-- (*t*)</span></div>              <div>                <span class="commandName">log</span> <span class="className">word</span><span class="normal"> 1 </span><span class="langKeyword">of</span> <span class="userDefine">a_text</span> <span class="comment">-- (*this*)</span></div>              <div>                <span class="commandName">log</span> <span class="propertyName">length</span> <span class="langKeyword">of</span> <span class="userDefine">a_text</span> <span class="comment">-- (*13*)</span></div>              <br />              <div>                <span class="comment">(*== Obtain content as AppleScript's text *)</span></div>              <div>                <span class="userDefine">a_text's</span> <span class="userDefine">as_unicode</span><span class="normal">()</span></div>              <div>                <span class="userDefine">a_text's</span> <span class="userDefine">as_string</span><span class="normal">()</span></div>            </div>          </csobj><!-- InstanceEndEditable --></div>      <!-- InstanceBeginEditable name="prev-next-item" --><div class="prev-next-item"><a href="../02_reference/index.html"><span class="navibar-next">XText Reference </span></a></div><!-- InstanceEndEditable -->      <div class="footer">        <p>This page was last built on <csobj format="MedDate" h="10" region="0" t="DateTime" w="73">Wed, Oct 19, 2016</csobj> ; <csobj format="LongTime" h="10" region="0" t="DateTime" w="46">9:20:29 AM</csobj> . Thanks for checking it out!</p>      </div>    </body>  <!-- InstanceEnd --></html>